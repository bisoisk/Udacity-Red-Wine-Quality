Red Wine Exploration by Darui Zhang
========================================================

What property makes great red wine great? In this project we will try to answer this question by exploring the red wine data set. 

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(GGally)
library(scales)
library(memisc)
library(lattice)
library(MASS)
library(gridExtra)
library(dplyr)
library(reshape)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
redwine<-read.csv('wineQualityReds.csv')
names(redwine)
```

#Univariate Plots Section
### Univariate Plots Selection

Feature names and summary
```{r echo=FALSE, Univariate_selection}
names(redwine)
summary(redwine)
```
This tidy data set contains 1,599 red wines with 11 variables on the chemical properties of the wine. 

### Wine Quality Distribution in the Dataset

The wine quality grade is a discrete number. It is ranged from 3 to 8. The median value is at 6.
```{r echo=FALSE, More_Univariate_Plots}
  ggplot(aes(x = quality), data = redwine)+
  geom_histogram(colour="black", fill="#993366", width=.7,binwidth = 1)+
  scale_x_discrete()+
  xlab("Wine Grade") + ylab("Count") +
  ggtitle("Distribution of Wine Grade")

```

### Exploring the distribution of other chemical properties

```{r echo=FALSE, Univariate_Plots}
p1<-
ggplot(aes(x = fixed.acidity), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.5)
p2<-
ggplot(aes(x = volatile.acidity), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.05)
p3<-
ggplot(aes(x = citric.acid), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.05)
p4<-
ggplot(aes(x = residual.sugar), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.4)
p5<-
ggplot(aes(x = chlorides), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.025)
p6<-
ggplot(aes(x = free.sulfur.dioxide), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 4)
p7<-
ggplot(aes(x = total.sulfur.dioxide), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 20)
p8<-
ggplot(aes(x = density), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.001)
p9<-
ggplot(aes(x = pH), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.05)
p10<-
ggplot(aes(x = sulphates), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.1)
p11<-
ggplot(aes(x = alcohol), data = redwine)+
  geom_bar(colour="black", fill="#993366", width=.7,binwidth = 0.25)

grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,ncol=3)
```

### Univariate Analysis

Some observed on the distribution of the chemical property can be made:

- **Normal**:  volatile.acidity, density, PH

- **Positively Skewed**: fixed.acidity, citric.acid, free.sulfur.dioxide, total.sulfur.dioxide,sulphates,alcohol

- **Long Tail**: residual.sugar, chlorides

### Rescale Variables 
The skewed and long tail data can be transformed toward more normally distribution by taking square root or log function of the data. 
Take alcohol as a example we compare the original, square root and log of the feature.


```{r echo=FALSE, feature_scale}
# original 
p1<-
ggplot(aes(x = sulphates), data = redwine)+
  geom_histogram(colour="black", fill="#993366", width=.7,binwidth = 0.1)
# square root

redwine$sqrt_sulphates=sqrt(redwine$sulphates)
p2<-
ggplot(aes(x = sqrt_sulphates), data = redwine)+
  geom_histogram(colour="black", fill="#993366", width=.7,binwidth = 0.05)
#log

redwine$log_sulphates=log(redwine$sulphates)
p3<-
ggplot(aes(x = log_sulphates), data = redwine)+
  geom_histogram(colour="black", fill="#993366", width=.7,binwidth = 0.1)

grid.arrange(p1,p2,p3,ncol=1)
```
The square root helps a little bit, the log scale is more normal distributed



# Bivariate Plots Section

### Bivariate Plots Selection

To have a glance at the data, plot matrix was use to evaluate the correlation between the wine quality and each chemical perproty.

```{r echo=FALSE, Bivariate_selection}
# create a plot matrix
#ggpairs(redwine,params=c(shape=I('.'),outlier.shap=I('.')))

```

The list of the top 4 factor that is correlated with the wine quality with a correlation value greater than 0.2

| Property         | r-value |
|------------------|---------|
| alcohol          | 0.476   |
| volatile.acidity | -0.391  |
| sulphates        | 0.251   |
| citric.acid      | 0.226   |

### Bivariate Analysis

```{r echo=FALSE, scatter_Plots_original}
ggplot(aes(x=quality,y=alcohol),data=redwine)+
  geom_point()
```
The original plot looks over plotted, so we add alpha value and 0.1, 0.5 and 0.9 percentile line to show the general trends.

```{r echo=FALSE, scatter_Plots_improved}
  ggplot(aes(x=quality,y=alcohol),data=redwine)+
  geom_point(color='#993366',alpha=1/4)+
  geom_line(stat='summary',fun.y = quantile,probs = .5,color='#FF6660')+
  geom_line(stat='summary',fun.y = quantile,probs = .9,
            linetype =2, color='#FF6660')+
  geom_line(stat='summary',fun.y = quantile,probs = .1,
            linetype =2, color='#FF6660')+
  xlab("Wine Grade") + ylab("Alcohol") +
  ggtitle("Wine Qaulity and Alchohol")
```
In this plot the trend of increasing wind quality with the increasing of alcohol content can be clearly observed. 

### Transforming Wine Quality into Categorical Data
Since the wine quality are desecrate value, we can transform it from numerical data to categorical data. And there, box plot can be used to represent the data.

```{r echo=FALSE, transform_data}
# turn quality  into categroical 
redwine$grade_number<-cut(redwine$quality, c(2.5,3.5,4.5,5.5,6.5,7.5,8.5),labels=c('3','4','5','6','7','8'))
```

```{r echo=FALSE, box_plot}
ggplot(redwine, aes(x=grade_number, y=alcohol,fill=grade_number)) + geom_boxplot()+
   xlab("Wine Grade") + ylab("Alcohol") +
  ggtitle("Alchohol vs Wine Grade")
```
In generally, higher quality wine have higher alcholol content

Similar we did the analysis on the other 3 factors
```{r echo=FALSE, more_box_plot}
p1<-
ggplot(redwine, aes(x=grade_number, y=volatile.acidity,fill=grade_number)) + geom_boxplot()+
   xlab("Wine Grade") + ylab("Volatile Acidity") +
  ggtitle("Volatile Acidity vs Wine Grade")
p2<-
ggplot(redwine, aes(x=grade_number, y=sulphates,fill=grade_number)) + geom_boxplot()+
   xlab("Wine Grade") + ylab("sulphates") +
  ggtitle("Sulphatesy vs Wine Grade")
p3<-
ggplot(redwine, aes(x=grade_number, y=citric.acid,fill=grade_number)) + geom_boxplot()+
   xlab("Wine Grade") + ylab("citric.acid") +
  ggtitle("Citric Acid vs Wine Grade")
grid.arrange(p1,p2,p3,ncol=1)

```
### Bivariate Analysis

```{r echo=FALSE, alchool_distribution_grade}
  ggplot(redwine, aes(x=alcohol, fill=grade_number)) +
  geom_histogram(binwidth=.5, alpha=.5, position="identity")
```
Notes that the data size is not normailize

```{r echo=FALSE, alchool_distribution_grade_normalized}
 ggplot(redwine, aes(x=alcohol, fill=grade_number)) +
  geom_density(aes(y=..density..),binwidth=.5, alpha=.5, position="identity")+
  xlab("Wine Grade") + ylab("Alcohol") +
  ggtitle("Alchohol Distribuiton of Differnt Wine Grade")
```
The plot looks a little busy. We ground 2 grade together

```{r echo=FALSE, grouping}
 #3,4 low 5,6,medium 7,8high
redwine$grade<-cut(redwine$quality, c(2.5,4.5,6.5,8.5),labels=c('Low','Medium','High'))
ggplot(redwine, aes(x=alcohol, fill=grade)) +
  geom_density(aes(y=..density..),binwidth=.5, alpha=.5, position="identity")+
  xlab("Wine Grade") + ylab("Alcohol") +
  ggtitle("Alchohol Distribuiton of Differnt Wine Grade")
```
this looks better

```{r echo=FALSE, more_distribution_grade}
ggplot(redwine, aes(x=volatile.acidity, fill=grade)) +
  geom_density(aes(y=..density..),binwidth=.5, alpha=.5, position="identity")+
  xlab("Wine Grade") + ylab("Volatile Acidity") +
  ggtitle("Volatile Acidity Distribuiton of Differnt Wine Grade")

ggplot(redwine, aes(x=citric.acid, fill=grade)) +
  geom_density(aes(y=..density..),binwidth=.5, alpha=.5, position="identity")+
  xlab("Wine Grade") + ylab("Citric Acid") +
  ggtitle("Citric Acid Distribuiton of Differnt Wine Grade")
```

skewed, we use log
```{r echo=FALSE, log_sulphates}

ggplot(redwine, aes(x=sulphates, fill=grade)) +
  geom_density(aes(y=..density..),binwidth=.5, alpha=.5, position="identity")+
  xlab("Wine Grade") + ylab("sulphates") +
  ggtitle("Sulphates Distribuiton of Differnt Wine Grade")

ggplot(redwine, aes(x=log_sulphates, fill=grade)) +
  geom_density(aes(y=..density..),binwidth=.5, alpha=.5, position="identity")+
  xlab("Wine Grade") + ylab("log_sulphates") +
  ggtitle("Sulphates Distribuiton of Differnt Wine Grade")
```

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?




# Multivariate Plots Section

we x-y color to represent the other variable, how to encode dimension into the plot

```{r echo=FALSE, Multivariate_Plots}
  ggplot(redwine, aes(y=alcohol,x=quality,color = volatile.acidity) )+
  geom_point(alpha=1/4,size=3)+
  scale_colour_gradient2(low="red", high="blue",mid="#9933CC",midpoint = 0.8)

```

is discrete number, problems of over plot, jitter
```{r echo=FALSE, jitter_Plots}
  ggplot(redwine, aes(y=alcohol,x=quality,color = volatile.acidity) )+
  geom_jitter(alpha=1/2,size=3)+
  scale_colour_gradient2(low="red", high="blue",mid="#9933CC",midpoint = 0.8)

```

use the 3 biggest factors
```{r echo=FALSE, facet}

ggplot(redwine, aes(x=alcohol,y=volatile.acidity)) +
  geom_point(aes(color =  log_sulphates),alpha=1/2,size=3)+
  scale_colour_gradient2(low="red", high="blue",mid="#9933CC",midpoint = -0.25)+
  facet_grid(grade ~ .) 
```

```{r echo=FALSE, grade_as}

ggplot(aes(x = volatile.acidity, y = alcohol), data = redwine) +
  geom_point(aes(color =  grade),size=2,)

ggplot(aes(x = log_sulphates, y = citric.acid), data = redwine) +
  geom_point(aes(color =  grade))
```

### Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection
